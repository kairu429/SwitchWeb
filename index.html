<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Switch風 Web Launcher — 軽量版</title>
  <style>
    :root{
      --icon-size:150px;
      --icon-gap:24px;
      --horizontal-padding:48px;
      --scroll-speed:300ms;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;height:100%;
      background:#dcdcdc;
      font-family: Inter, system-ui, -apple-system, "Noto Sans JP", "Yu Gothic", sans-serif;
      color:#0b1220; overflow:hidden;
      display:flex; align-items:center; justify-content:center;
    }

    .launcher-wrap{ width:100%; height:100%; display:flex; flex-direction:column; align-items:flex-start; justify-content:center; position:relative; }

    .rack{ width:100%; display:flex; align-items:center; justify-content:flex-start; overflow:hidden; padding-left:var(--horizontal-padding); }
    .carousel{ display:flex; align-items:center; gap:var(--icon-gap); padding-right:var(--horizontal-padding); will-change:transform; transition:transform var(--scroll-speed) ease-out; transform:translateX(0); }

    .tile{ width:var(--icon-size); height:var(--icon-size); border-radius:16px; background:#fff; display:flex; align-items:center; justify-content:center; flex-shrink:0; box-shadow:0 4px 12px rgba(12,20,40,0.08); transform-origin:center center; transition: transform 200ms, box-shadow 200ms, border 200ms; position:relative; cursor:pointer; }
    .tile.selected{ transform: scale(1.05); z-index:80; box-shadow:0 15px 40px rgba(12,20,40,0.2); border:3px solid #fff; }

    .icon-img{ width:100%; height:100%; object-fit:contain; border-radius:12px; display:block; }

    .mini-label{ position:absolute; bottom:calc(100% + 10px); left:50%; transform:translateX(-50%); background:rgba(255,255,255,0.95); padding:4px 10px; border-radius:8px; font-weight:700; font-size:14px; box-shadow:0 4px 12px rgba(12,20,40,0.08); white-space:nowrap; pointer-events:none; color:#0b1220; opacity:0; transition:opacity 200ms; }
    .tile.selected .mini-label{ opacity:1; }

    .footer{ position:fixed; bottom:14px; left:50%; transform:translateX(-50%); display:flex; gap:14px; align-items:center; font-size:13px; color:#333; z-index:110 }

    @media (max-width:640px){ :root{ --icon-gap:16px; --icon-size:120px; } }
  </style>
</head>
<body>
  <div class="launcher-wrap" role="application" aria-label="Web Launcher">
    <div class="rack">
      <div id="carousel" class="carousel" role="list" aria-label="Icon list"></div>
    </div>
    <div class="footer">← → : 選択　　Enter / A : 開く</div>
  </div>

  <script>
    const DEFAULT_APPS = [
      {name:'YouTube', url:'https://www.youtube.com'},
      {name:'Google', url:'https://www.google.com'},
      {name:'Twitter', url:'https://twitter.com'},
      {name:'Discord', url:'https://discord.com'},
      {name:'GitHub', url:'https://github.com'}
    ];
    const STORAGE_KEY = 'switch_launcher_light';
    let apps = loadApps();
    let selected = 0;

    const carousel = document.getElementById('carousel');
    let currentOffset = 0;

    function loadApps(){ try{ const raw = localStorage.getItem(STORAGE_KEY); if(raw) return JSON.parse(raw); }catch(e){} return DEFAULT_APPS.slice(); }
    function saveApps(){ try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(apps)); }catch(e){} }

    function render(){
      carousel.innerHTML = '';
      apps.forEach((app, idx)=>{
        const tile = document.createElement('div');
        tile.className = 'tile';
        tile.dataset.idx = idx;

        const img = document.createElement('img');
        img.className = 'icon-img';
        img.src = `https://www.google.com/s2/favicons?sz=256&domain=${new URL(app.url).hostname}`;
        img.alt = app.name;
        tile.appendChild(img);

        const label = document.createElement('div');
        label.className = 'mini-label';
        label.textContent = app.name;
        tile.appendChild(label);

        carousel.appendChild(tile);
      });
      updateSelection(false);
      centerTile(carousel.querySelector('.tile.selected'), false);
    }

    function updateSelection(animate=true){
      const tiles = Array.from(carousel.querySelectorAll('.tile'));
      tiles.forEach(t=>t.classList.remove('selected'));
      const selTile = tiles[selected];
      if(selTile){ selTile.classList.add('selected'); centerTile(selTile, animate); }
    }

    function centerTile(tile, animate){
      if(!tile) return;
      const tileRect = tile.getBoundingClientRect();
      const viewportCenter = window.innerWidth / 2;
      const tileCenter = tileRect.left + tileRect.width / 2;
      const delta = viewportCenter - tileCenter;
      currentOffset += delta;
      carousel.style.transition = animate ? 'transform 400ms ease-out' : 'none';
      carousel.style.transform = `translateX(${currentOffset}px)`;
    }

    function move(dir){
      const max = apps.length - 1;
      let n = selected + dir;
      if(n<0) n=0; if(n>max) n=max;
      if(n!==selected){ selected=n; updateSelection(true); }
    }

    function openApp(i){ if(!apps[i]) return; window.open(apps[i].url, '_blank'); }

    window.addEventListener('keydown',(e)=>{
      if(e.key==='ArrowLeft'){ move(-1); e.preventDefault(); }
      if(e.key==='ArrowRight'){ move(1); e.preventDefault(); }
      if(e.key==='Enter'){ openApp(selected); e.preventDefault(); }
    });

    window.addEventListener('resize', ()=>{ setTimeout(()=>updateSelection(false),60); });
    window.addEventListener('load', ()=>{ render(); });
  </script>
</body>
</html>
