<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>Switché¢¨ Webãƒ©ãƒ³ãƒãƒ£ãƒ¼ â€” é¸æŠæ  & åå‰ãƒ©ãƒ™ãƒ«ç‰ˆ</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg1:#0d0d0d;
      --bg2:#1a1a1a;
      --accent:#00bfff;
      --icon-size:140px;
      --gap:50px;
    }

    html,body{height:100%;margin:0;}
    body{
      background: linear-gradient(180deg,var(--bg1),var(--bg2));
      color:#fff;
      font-family:"Segoe UI", system-ui, -apple-system, "Helvetica Neue", Arial;
      display:flex;
      flex-direction:column;
      overflow:hidden;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ / é¸æŠãƒ©ãƒ™ãƒ« */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:10px 24px;
      color:#cfcfcf;
      gap:12px;
    }
    #selected-label{
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      top:18px;
      font-weight:700;
      color:var(--accent);
      font-size:18px;
      opacity:0;
      transition:opacity .18s ease, transform .18s ease;
      pointer-events:none;
      white-space:nowrap;
    }

    .status-right{margin-left:auto; display:flex; gap:14px; align-items:center; color:#bfbfbf;}

    /* ãƒ©ãƒ³ãƒãƒ£ãƒ¼é ˜åŸŸ â€” é«˜ã•ä¸­å¤®ã«é…ç½® */
    .launcher-wrap{position:relative; flex:1; display:flex; align-items:center; justify-content:center; overflow:hidden;}
    .launcher{
      display:flex;
      align-items:center; /* é«˜ã•ã¯ä¸­å¤® */
      overflow-x:auto;
      gap:var(--gap);
      padding:20px 80px;
      transition:transform .18s ease;
      /* hide scrollbar elegantly */
      scrollbar-width:none; -ms-overflow-style:none;
    }
    .launcher::-webkit-scrollbar{display:none;}

    .app{
      position:relative;
      width:var(--icon-size);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-end; /* åå‰ã¯ä¸Šã«å‡ºã™ã®ã§é…ç½®èª¿æ•´ */
      flex-shrink:0;
      transition:transform .18s ease;
    }

    .icon{
      width:var(--icon-size);
      height:var(--icon-size);
      border-radius:18px;
      background:#222;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      box-shadow:0 6px 18px rgba(0,0,0,0.45);
      transition:box-shadow .18s ease, border .12s ease;
      position:relative;
      z-index:1;
    }
    .icon img{width:100%;height:100%;object-fit:cover;display:block;border-radius:18px;}

    /* å°ã•ãªã‚¢ãƒ—ãƒªåã¯ã‚¢ã‚¤ã‚³ãƒ³ã®å°‘ã—ä¸Šã«è¡¨ç¤ºï¼ˆæ™®æ®µï¼‰ */
    .app-name{
      position:absolute;
      top:-28px; /* ã‚¢ã‚¤ã‚³ãƒ³ã®ä¸Šã« */
      width:100%;
      text-align:center;
      font-size:14.5px;
      font-weight:700;
      color:var(--accent);
      pointer-events:none;
      transition:opacity .12s ease, transform .12s ease;
      white-space:nowrap;
    }

    /* é¸æŠæ™‚ï¼šã‚¢ã‚¤ã‚³ãƒ³ã¯æ‹¡å¤§ã—ãªã„ã€‚ä»£ã‚ã‚Šã«æ°´è‰²ã®æ ï¼ˆã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ï¼‰ã¨å…‰ã‚Šã‚’å‡ºã™ */
    .app.selected .icon{
      border:3px solid rgba(0,191,255,0.95);
      box-shadow:0 8px 30px rgba(0,191,255,0.18), 0 4px 10px rgba(0,0,0,0.35);
      /* no scale */
      transform: none;
    }

    /* éé¸æŠã‚¢ã‚¤ã‚³ãƒ³ã‚’å°‘ã—å·¦è©°ã‚ã‚‹ï¼ˆé¸æŠæ™‚ã«ã ã‘é©ç”¨ï¼‰ */
    .launcher.compact .app:not(.selected){
      transform: translateX(-8px);
    }

    /* é¸æŠæ™‚ã¯å„ã‚¢ã‚¤ã‚³ãƒ³ä¸Šã®å°åã¯ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆï¼ˆåå‰ã¯ä¸­å¤®ãƒ©ãƒ™ãƒ«ã¸ï¼‰ */
    .app.selected .app-name { opacity:0; transform:translateY(-6px); }

    /* delete button */
    .delete-btn{
      position:absolute;
      top:-10px;
      right:-10px;
      width:26px;height:26px;border-radius:50%;
      border:none;background:#ff5c5c;color:#fff;cursor:pointer;
      display:none;font-weight:700;
      box-shadow:0 2px 6px rgba(0,0,0,0.4);
      z-index:2;
    }
    .app:hover .delete-btn{ display:block; }

    /* ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆä¸‹ï¼‰ */
    .menu{
      display:flex;
      justify-content:center;
      gap:36px;
      padding:12px;
      border-top:1px solid rgba(255,255,255,0.04);
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    }
    .menu-item{ color:#ddd; font-weight:600; cursor:pointer; user-select:none; }

    /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–èª¿æ•´ */
    @media (max-width:900px){
      :root{ --icon-size:120px; --gap:34px; }
      #selected-label{ font-size:16px; top:14px; }
    }
  </style>
</head>
<body>
  <div class="topbar">
    <div id="selected-label" aria-live="polite"></div>
    <div class="status-right">
      <div id="time"></div>
      <div id="battery">ğŸ”‹ --%</div>
    </div>
  </div>

  <div class="launcher-wrap">
    <div class="launcher" id="launcher" role="listbox" aria-label="ã‚¢ãƒ—ãƒªãƒ©ãƒ³ãƒãƒ£ãƒ¼">
      <!-- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¤ãƒ†ãƒ  -->
      <div class="app selected" data-url="https://www.google.com" role="option" aria-selected="true">
        <div class="app-name">Google</div>
        <div class="icon"><img src="https://www.google.com/favicon.ico" alt="Google"></div>
        <button class="delete-btn" title="å‰Šé™¤">Ã—</button>
      </div>

      <div class="app" data-url="https://www.youtube.com" role="option" aria-selected="false">
        <div class="app-name">YouTube</div>
        <div class="icon"><img src="https://www.youtube.com/favicon.ico" alt="YouTube"></div>
        <button class="delete-btn" title="å‰Šé™¤">Ã—</button>
      </div>

      <div class="app" data-url="https://discord.com" role="option" aria-selected="false">
        <div class="app-name">Discord</div>
        <div class="icon"><img src="https://discord.com/favicon.ico" alt="Discord"></div>
        <button class="delete-btn" title="å‰Šé™¤">Ã—</button>
      </div>

      <div class="app" data-url="https://github.com" role="option" aria-selected="false">
        <div class="app-name">GitHub</div>
        <div class="icon"><img src="https://github.com/favicon.ico" alt="GitHub"></div>
        <button class="delete-btn" title="å‰Šé™¤">Ã—</button>
      </div>

      <div class="app" id="add-app" role="option" aria-selected="false">
        <div class="app-name">è¿½åŠ </div>
        <div class="icon">ï¼‹</div>
      </div>
    </div>
  </div>

  <div class="menu">
    <div class="menu-item">è¨­å®š</div>
    <div class="menu-item">ã‚¹ãƒˆã‚¢</div>
    <div class="menu-item">é›»æº</div>
  </div>

  <script>
    const launcher = document.getElementById('launcher');
    let apps = () => Array.from(launcher.querySelectorAll('.app'));
    let selectedIndex = 0;

    const selectedLabel = document.getElementById('selected-label');

    // åˆæœŸè¡¨ç¤ºãƒ©ãƒ™ãƒ«
    function refreshSelectedLabel() {
      const app = apps()[selectedIndex];
      if (!app) { selectedLabel.style.opacity = 0; return; }
      const name = app.querySelector('.app-name')?.textContent || '';
      // è¡¨ç¤ºï¼ˆãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ï¼‰
      selectedLabel.textContent = name;
      selectedLabel.style.opacity = 1;
      selectedLabel.style.transform = 'translateX(-50%) translateY(0)';
      // compact ã‚¯ãƒ©ã‚¹ã¯é¸æŠæ™‚ã« ONï¼ˆéé¸æŠã‚¢ã‚¤ã‚³ãƒ³ã‚’å·¦ã¸è©°ã‚ã‚‹ï¼‰
      launcher.classList.add('compact');
      // aria
      apps().forEach((a,i)=> a.setAttribute('aria-selected', i===selectedIndex ? 'true' : 'false'));
    }

    function clearSelectedLabel() {
      selectedLabel.style.opacity = 0;
      selectedLabel.style.transform = 'translateX(-50%) translateY(-4px)';
      launcher.classList.remove('compact');
    }

    function updateSelection() {
      apps().forEach((app, i) => {
        app.classList.toggle('selected', i === selectedIndex);
      });
      // åå‰ãƒ©ãƒ™ãƒ«ã‚’æ›´æ–°ï¼ˆadd-appä»¥å¤–ï¼‰
      const sel = apps()[selectedIndex];
      if (sel && sel.id !== 'add-app') refreshSelectedLabel();
      else clearSelectedLabel();
      // ensure the selected item is visible (smooth scroll)
      scrollSelectedIntoView();
    }

    // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§é¸æŠã‚¢ã‚¤ã‚³ãƒ³ã‚’ã§ãã‚‹ã ã‘ä¸­å¤®å¯„ã›ï¼ˆæ¨ªæ–¹å‘ï¼‰
    function scrollSelectedIntoView() {
      const sel = apps()[selectedIndex];
      if (!sel) return;
      const launcherRect = launcher.getBoundingClientRect();
      const selRect = sel.getBoundingClientRect();
      const offset = (selRect.left + selRect.right) / 2 - (launcherRect.left + launcherRect.right) / 2;
      // smooth adjust
      launcher.scrollBy({ left: offset, behavior: 'smooth' });
    }

    // å‰Šé™¤
    function deleteSelectedApp() {
      const a = apps()[selectedIndex];
      if (a && a.id !== 'add-app') {
        a.remove();
        if (selectedIndex >= apps().length) selectedIndex = apps().length - 1;
        updateSelection();
      }
    }

    // é–‹ã / è¿½åŠ 
    function openSelectedApp() {
      const a = apps()[selectedIndex];
      if (!a) return;
      if (a.id === 'add-app') {
        const name = prompt('ã‚¢ãƒ—ãƒªåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
        const url = prompt('URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
        if (name && url) {
          const item = document.createElement('div');
          item.className = 'app';
          item.dataset.url = url;
          item.innerHTML = `
            <div class="app-name"></div>
            <div class="icon"><img src="${new URL(url).origin + '/favicon.ico'}" alt="${name}"></div>
            <button class="delete-btn" title="å‰Šé™¤">Ã—</button>
          `;
          item.querySelector('.app-name').textContent = name;
          item.querySelector('.delete-btn').addEventListener('click', (e)=>{
            e.stopPropagation();
            item.remove();
            if (selectedIndex >= apps().length) selectedIndex = apps().length - 1;
            updateSelection();
          });
          launcher.insertBefore(item, document.getElementById('add-app'));
          selectedIndex = apps().indexOf(item);
          updateSelection();
        }
      } else {
        const url = a.dataset.url;
        if (url) window.open(url, '_blank');
      }
    }

    // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œ
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight') {
        selectedIndex = (selectedIndex + 1) % apps().length;
        updateSelection();
      } else if (e.key === 'ArrowLeft') {
        selectedIndex = (selectedIndex - 1 + apps().length) % apps().length;
        updateSelection();
      } else if (e.key === 'Enter') {
        openSelectedApp();
      } else if (e.key.toLowerCase() === 'x') {
        deleteSelectedApp();
      }
    });

    // ã‚¯ãƒªãƒƒã‚¯ã§é¸æŠ / ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§é–‹ã / å‰Šé™¤ãƒœã‚¿ãƒ³
    launcher.addEventListener('click', (e)=>{
      const app = e.target.closest('.app');
      if (!app) return;
      const idx = apps().indexOf(app);
      if (idx >= 0) {
        selectedIndex = idx;
        updateSelection();
      }
    });
    launcher.addEventListener('dblclick', (e)=>{
      const app = e.target.closest('.app');
      if (!app) return;
      const idx = apps().indexOf(app);
      if (idx >= 0) {
        selectedIndex = idx;
        openSelectedApp();
      }
    });
    launcher.addEventListener('click', (e)=>{
      if (e.target.classList.contains('delete-btn')) {
        const app = e.target.closest('.app');
        const idx = apps().indexOf(app);
        if (idx >= 0) {
          app.remove();
          if (selectedIndex >= apps().length) selectedIndex = apps().length - 1;
          updateSelection();
        }
      }
    });

    // ã‚²ãƒ¼ãƒ ãƒ‘ãƒƒãƒ‰å¯¾å¿œï¼ˆå·¦å³ã‚¹ãƒ†ã‚£ãƒƒã‚¯ + åå­—ã‚­ãƒ¼ + A/Xï¼‰
    let gpState = { axisLeft:false, axisRight:false, buttons:[] };
    const axisThreshold = 0.5;

    function pollGamepad(){
      const gp = navigator.getGamepads && navigator.getGamepads()[0];
      if (gp) {
        const buttons = gp.buttons.map(b=>b.pressed);
        const axes = gp.axes;

        // åå­—ã‚­ãƒ¼ï¼ˆRight:15, Left:14ï¼‰, A:0, X:2
        if (buttons[15] && !gpState.buttons[15]) { selectedIndex = (selectedIndex + 1) % apps().length; updateSelection(); }
        if (buttons[14] && !gpState.buttons[14]) { selectedIndex = (selectedIndex - 1 + apps().length) % apps().length; updateSelection(); }

        // å·¦ã‚¹ãƒ†ã‚£ãƒƒã‚¯æ¨ª
        if (axes[0] > axisThreshold && !gpState.axisRight) { selectedIndex = (selectedIndex + 1) % apps().length; gpState.axisRight = true; updateSelection(); }
        else if (axes[0] < -axisThreshold && !gpState.axisLeft) { selectedIndex = (selectedIndex - 1 + apps().length) % apps().length; gpState.axisLeft = true; updateSelection(); }
        else if (Math.abs(axes[0]) < axisThreshold) { gpState.axisRight = gpState.axisLeft = false; }

        // A / X
        if (buttons[0] && !gpState.buttons[0]) openSelectedApp();
        if (buttons[2] && !gpState.buttons[2]) deleteSelectedApp();

        gpState.buttons = buttons;
      }
      requestAnimationFrame(pollGamepad);
    }
    pollGamepad();

    // æ™‚é–“ã¨ãƒãƒƒãƒ†ãƒªãƒ¼
    function updateTime(){
      const now = new Date();
      document.getElementById('time').textContent = now.toLocaleTimeString('ja-JP',{hour:'2-digit',minute:'2-digit'});
    }
    setInterval(updateTime,1000);
    updateTime();

    if (navigator.getBattery){
      navigator.getBattery().then(b=>{
        function upd(){ document.getElementById('battery').textContent = 'ğŸ”‹ ' + Math.round(b.level*100) + '%'; }
        upd();
        b.addEventListener('levelchange', upd);
      });
    }

    // åˆæœŸé¸æŠè¡¨ç¤º
    updateSelection();

    // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚µã‚¤ã‚ºã§é¸æŠã‚¢ã‚¤ãƒ†ãƒ ä¸­å¤®åŒ–ï¼ˆå°‘ã—é…å»¶ã—ã¦ã„ã„æ„Ÿã˜ã«ï¼‰
    let resizeTimer;
    window.addEventListener('resize', ()=>{
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(()=>{ scrollSelectedIntoView(); }, 120);
    });
  </script>
</body>
</html>
